
<div class="alert alert-warning alert-dismissible fade show text-center" role="alert" id="warning-message">
Cada turno es para un único perro. Si tienes más de un perro, por favor, saca un turno para cada uno.
</div>

<%= form_with(model: @turn_form, local: true) do |form| %>
    <!--Error messages-->
    <% if @turn_form.errors.any? %>
        <div class="alert alert-danger">
            <h4 class="alert-heading"><%= pluralize(@turn_form.errors.count, "error","errores") %> <%= (@turn_form.errors.count == 1) ? "impide" : "impiden" %> que se complete el formulario</h4>
            <ul>
                <% @turn_form.errors.each do |error| %>
                    <li><%= error.full_message.humanize %></li>
                <% end %>
            </ul>
        </div>
    <% end %>

    <!--Select motive. compatibility with Service database?--> 
    <div class="row">
        <div class="col-sm-3">
            <label>Selecciona los servicios:</label>
        </div>
        <div class="col-sm-9">
            <table class="table">
                <thead>
                    <tr>
                        <th>Nombre del Servicio</th>
                        <th>Precio</th>
                        <th>Seleccionar</th>
                    </tr>
                </thead>
                <tbody>
                    <% Service.all.each do |service| %>
                        <% if service.active %>
                            <tr>
                                <td><%= service.name %></td>
                                <td><%= service.price %></td>
                                <td>
                                    <div class="form-check">
                                        <%= form.check_box :service_ids, { multiple: true }, service.id, nil %>
                                    </div>
                                </td>
                            </tr>
                            <% end %>
                    <% end %>
                </tbody>
            </table>
        </div>
    </div>

    <!--Time select-->
    <div class="row mb-3">
        <%= form.label :dateCons, "Fecha de la consulta", class: "col-sm-2 col-form-label" %>
        <div class="col-md-10">
            <%= form.date_field :dateCons, class: 'form-control flatpickr', id: 'date-picker' %>
        </div>
    </div>

    <!--ScheduleDate-->
    <div class="row mb-3">
        <%= form.label :schedule, "Banda horaria", class: "col-sm-2 col-form-label" %>
        <div class="col-md-10">
            <%= form.select(:schedule, 
                  [['', nil]] + TurnForm.schedules.keys.map { |schedule| [t("activerecord.attributes.turn_form.schedules.#{schedule}").humanize, schedule] },
                  { selected: nil },
                  { class: 'form-select' }) %>
        </div>
    </div>

    <!-- Seleccionar un perro del cliente  -->
    <div class="row mb-3">
        <%= form.label :dog_id, "Seleccione a su mascota", class: "col-sm-3 col-form-label" %>
        <div class="col-md-9">
            <%= form.collection_select(:dog_id, current_user.dogs, :id, :first_name, { prompt: "", required: true }, { class: 'form-select' }) %>
        </div>
    </div>

    <!-- Description field -->
    <div class="row mb-3">  
        <%= form.label :descriptionCons, "Descripción", class: "col-sm-2 col-form-label" %>
        <div class="col-sm-10">
            <%= form.text_area :descriptionCons, class: 'form-control', rows: 4 %>
        </div>
    </div>

    <!-- sent button -->
    <div class="text-center">
        <%= form.submit "Solicitar", data: { confirm: "Estás seguro?", turbo_confirm: "Estás seguro?" }, class: "btn btn-primary mt-3" %>
    </div>
<% end %>





